"use strict";(self.webpackChunkreactiquiz=self.webpackChunkreactiquiz||[]).push([[450],{1450:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var o=r(9379),s=r(45),n=r(5043),a=r(267),l=r(5895),i=r(3969),d=r(4799),c=r(5315),p=r(2394),u=r(8387),x=r(1807),m=r(9066),A=r(8128),h=r(8301),g=r(9857),y=r(6061);function f(e){return(0,y.Ay)("MuiListItemAvatar",e)}(0,g.A)("MuiListItemAvatar",["root","alignItemsFlexStart"]);var v=r(579);const j=["className"],b=(0,A.Ay)("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,"flex-start"===r.alignItems&&t.alignItemsFlexStart]}})({minWidth:56,flexShrink:0,variants:[{props:{alignItems:"flex-start"},style:{marginTop:8}}]}),I=n.forwardRef((function(e,t){const r=(0,h.b)({props:e,name:"MuiListItemAvatar"}),{className:a}=r,l=(0,s.A)(r,j),i=n.useContext(m.A),d=(0,o.A)((0,o.A)({},r),{},{alignItems:i.alignItems}),c=(e=>{const{alignItems:t,classes:r}=e,o={root:["root","flex-start"===t&&"alignItemsFlexStart"]};return(0,x.A)(o,f,r)})(d);return(0,v.jsx)(b,(0,o.A)({className:(0,u.A)(c.root,a),ownerState:d,ref:t},l))}));var S=r(7873),w=r(6185),k=r(172),C=r(6803),z=r(6154),M=r(2579),E=r(7171),L=r(1422),R=r(9118),T=r(7395),P=r(411);var W=r(5016);const B=["node"],D=["node"],F=["node"],G=["node"],N=["node"],Q=["node"];const q=function(){const e=(0,a.A)(),{currentUser:t}=(0,W.A)(),{messages:r,input:u,setInput:x,isLoading:m,error:A,handleSendMessage:h}=(()=>{const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(""),[s,a]=(0,n.useState)(!1),[l,i]=(0,n.useState)(null);(0,n.useEffect)((()=>{t([{role:"model",parts:[{text:"Hello! I'm Q, your personal study assistant. How can I help you prepare for your exams or analyze your results today?"}]}])}),[]);const d=(0,n.useCallback)((async n=>{if(n&&n.preventDefault(),!r.trim()||s)return;const l={role:"user",parts:[{text:r}]},d=[...e,l];t(d),o(""),a(!0),i(null);try{const o=e,s={role:"model",parts:[{text:(await P.A.post("/api/ai/chat",{history:o,message:r.trim()})).data.response}]};t((e=>[...e,s]))}catch(u){var c,p;const e=(null===(c=u.response)||void 0===c||null===(p=c.data)||void 0===p?void 0:p.error)||"Sorry, something went wrong. Please try again.";i(e),t((t=>[...t,{role:"model",parts:[{text:e}],isError:!0}]))}finally{a(!1)}}),[r,s,e]);return{messages:e,input:r,setInput:o,isLoading:s,error:l,handleSendMessage:d}})(),g=(0,n.useRef)(null);(0,n.useEffect)((()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[r]);const y=e.palette.info.main,f={p:e=>{let{node:t}=e,r=(0,s.A)(e,B);return(0,v.jsx)(l.A,(0,o.A)({variant:"body1",paragraph:!0,sx:{mb:1,"&:last-child":{mb:0}}},r))},strong:e=>{let{node:t}=e,r=(0,s.A)(e,D);return(0,v.jsx)(l.A,(0,o.A)({component:"span",fontWeight:"bold"},r))},em:e=>{let{node:t}=e,r=(0,s.A)(e,F);return(0,v.jsx)(l.A,(0,o.A)({component:"span",fontStyle:"italic"},r))},ol:e=>{let{node:t}=e,r=(0,s.A)(e,G);return(0,v.jsx)("ol",(0,o.A)({style:{paddingInlineStart:"20px",margin:0}},r))},ul:e=>{let{node:t}=e,r=(0,s.A)(e,N);return(0,v.jsx)("ul",(0,o.A)({style:{paddingInlineStart:"20px",margin:0}},r))},li:e=>{let{node:t}=e,r=(0,s.A)(e,Q);return(0,v.jsx)("li",{style:{marginBottom:"4px"},children:(0,v.jsx)(l.A,(0,o.A)({component:"span"},r))})}};return(0,v.jsx)(i.A,{sx:{display:"flex",flexDirection:"column",height:"calc(100vh - 64px - 49px)",p:{xs:1,sm:2}},children:(0,v.jsxs)(d.A,{elevation:3,sx:{flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,v.jsx)(i.A,{sx:{p:2,borderBottom:"1px solid ".concat(e.palette.divider),backgroundColor:e.palette.background.default},children:(0,v.jsxs)(l.A,{variant:"h5",sx:{color:y,display:"flex",alignItems:"center",gap:1},children:[(0,v.jsx)(L.A,{})," AI Study Center"]})}),(0,v.jsxs)(c.A,{sx:{flexGrow:1,overflowY:"auto",p:2},children:[r.map(((r,o)=>(0,v.jsxs)(p.Ay,{sx:{alignItems:"flex-start",py:1.5},children:[(0,v.jsx)(I,{children:(0,v.jsx)(S.A,{sx:{bgcolor:"user"===r.role?e.palette.secondary.main:y},children:"user"===r.role?(0,v.jsx)(R.A,{}):(0,v.jsx)(L.A,{})})}),(0,v.jsx)(d.A,{elevation:1,sx:{p:1.5,borderRadius:3,bgcolor:r.isError?e.palette.error.dark:"user"===r.role?"background.paper":e.palette.background.default,border:"user"===r.role?"1px solid ".concat(e.palette.divider):"none",whiteSpace:"pre-wrap",wordBreak:"break-word",flexGrow:1},children:(0,v.jsx)(w.A,{primary:"user"===r.role?(null===t||void 0===t?void 0:t.name)||"You":"ReactiQuiz AI",primaryTypographyProps:{fontWeight:"bold",color:r.isError?e.palette.error.contrastText:"text.primary"},secondary:(0,v.jsx)(T.oz,{components:f,children:r.parts[0].text}),secondaryTypographyProps:{color:r.isError?e.palette.error.contrastText:"text.secondary",component:"div"}})})]},o))),m&&(0,v.jsxs)(p.Ay,{sx:{justifyContent:"center"},children:[(0,v.jsx)(k.A,{size:24,sx:{color:y}}),(0,v.jsx)(l.A,{sx:{ml:1},color:"text.secondary",children:"Q is thinking..."})]}),(0,v.jsx)("div",{ref:g})]}),A&&!m&&(0,v.jsx)(C.A,{severity:"error",sx:{m:2,mt:0},children:A}),(0,v.jsx)(i.A,{component:"form",onSubmit:h,sx:{p:2,borderTop:"1px solid ".concat(e.palette.divider),backgroundColor:e.palette.background.default},children:(0,v.jsx)(z.A,{fullWidth:!0,variant:"outlined",placeholder:"Ask about your results, a concept, or exam strategy...",value:u,onChange:e=>x(e.target.value),disabled:m,InputProps:{endAdornment:(0,v.jsx)(M.A,{type:"submit",color:"primary",disabled:m||!u.trim(),sx:{color:y},children:(0,v.jsx)(E.A,{})})}})})]})})}},7171:(e,t,r)=>{r.d(t,{A:()=>n});var o=r(9992),s=r(579);const n=(0,o.A)((0,s.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send")}}]);
//# sourceMappingURL=450.74966e06.chunk.js.map