"use strict";(self.webpackChunkreactiquiz=self.webpackChunkreactiquiz||[]).push([[205],{441:(e,t,n)=>{n.d(t,{A:()=>x});var o=n(9379),r=n(45),i=(n(5043),n(7395)),s=n(3684),l=n(809),a=n(5895),c=n(1202),d=n(579);const u=["node"],h=["node"];const x=function(e){let{text:t}=e;return t?(0,d.jsx)(i.oz,{remarkPlugins:[s.A],rehypePlugins:[l.A],components:{p:e=>{let{node:t}=e,n=(0,r.A)(e,u);return(0,d.jsx)(a.A,(0,o.A)({variant:"inherit",component:"div",sx:{mt:1,mb:1}},n))},a:e=>{let{node:t}=e,n=(0,r.A)(e,h);return(0,d.jsx)(c.A,(0,o.A)({},n))}},children:t}):null}},1386:(e,t,n)=>{n.d(t,{f:()=>o});const o=e=>{if(null==e||"number"!==typeof e||e<0)return"N/A";const t=Math.floor(e/3600),n=Math.floor(e%3600/60),o=Math.floor(e%60),r=String(t).padStart(2,"0"),i=String(n).padStart(2,"0"),s=String(o).padStart(2,"0");return t>0?"".concat(r,"h ").concat(i,"m ").concat(s,"s"):n>0?"".concat(i,"m ").concat(s,"s"):"".concat(s,"s")}},2199:(e,t,n)=>{n.d(t,{A:()=>C});var o=n(5043),r=n(267),i=n(3023),s=n(1911),l=n(8776),a=n(5895),c=n(3969),d=n(172),u=n(256),h=n(9067),x=n(4938),p=n(7471),m=n(6803),g=n(5877),A=n(2097),f=n(9826),v=n(5452),j=n(411),b=n(579);const C=function(e){var t;let{open:n,onClose:C,currentUser:y,quizDataForChallenge:w,accentColor:k}=e;const z=(0,r.A)(),[S,I]=(0,o.useState)([]),[D,q]=(0,o.useState)(!1),[F,B]=(0,o.useState)(""),[T,L]=(0,o.useState)(""),[Q,N]=(0,o.useState)(""),[R,P]=(0,o.useState)(!1),W=k||z.palette.secondary.main,H=(0,o.useCallback)((async()=>{if(null!==y&&void 0!==y&&y.token){q(!0),L("");try{const e=await j.A.get("/api/friends",{headers:{Authorization:"Bearer ".concat(y.token)}});I(e.data||[])}catch(e){L("Failed to load your friends list."),console.error("Error fetching friends:",e)}finally{q(!1)}}}),[null===y||void 0===y?void 0:y.token]);return(0,o.useEffect)((()=>{n&&(H(),B(""),L(""),N(""),P(!1))}),[n,H]),(0,b.jsxs)(i.A,{open:n,onClose:C,PaperProps:{sx:{minWidth:"320px",maxWidth:"500px"}},children:[(0,b.jsx)(s.A,{sx:{backgroundColor:W,color:z.palette.getContrastText(W),pb:1.5,pt:2},children:"Challenge a Friend"}),(0,b.jsxs)(l.A,{sx:{pt:"20px !important",display:"flex",flexDirection:"column",gap:2},children:[(0,b.jsx)(a.A,{variant:"body2",gutterBottom:!0,children:"You are about to challenge a friend using the following quiz:"}),(0,b.jsxs)(c.A,{sx:{pl:1,borderLeft:"3px solid ".concat(W),mb:1},children:[(0,b.jsxs)(a.A,{variant:"body2",children:[(0,b.jsx)("strong",{children:"Topic:"})," ",(null===w||void 0===w?void 0:w.topicName)||"N/A"]}),(0,b.jsxs)(a.A,{variant:"body2",children:[(0,b.jsx)("strong",{children:"Difficulty:"})," ",(null===w||void 0===w?void 0:w.difficulty)||"N/A"]}),(0,b.jsxs)(a.A,{variant:"body2",children:[(0,b.jsx)("strong",{children:"Questions:"})," ",(null===w||void 0===w||null===(t=w.questionIds)||void 0===t?void 0:t.length)||"N/A"]}),(null===w||void 0===w?void 0:w.quizClass)&&(0,b.jsxs)(a.A,{variant:"body2",children:[(0,b.jsx)("strong",{children:"Class:"})," ",w.quizClass]}),(null===w||void 0===w?void 0:w.subject)&&(0,b.jsxs)(a.A,{variant:"body2",children:[(0,b.jsx)("strong",{children:"Subject:"})," ",w.subject]})]}),D?(0,b.jsx)(d.A,{sx:{alignSelf:"center",color:W}}):(0,b.jsxs)(u.A,{fullWidth:!0,margin:"normal",disabled:0===S.length,children:[(0,b.jsx)(h.A,{id:"select-friend-label-challenge",children:"Select Friend to Challenge"}),(0,b.jsxs)(x.A,{labelId:"select-friend-label-challenge",value:F,label:"Select Friend to Challenge",onChange:e=>B(e.target.value),MenuProps:{PaperProps:{sx:{backgroundColor:z.palette.background.paper}}},children:[(0,b.jsx)(p.A,{value:"",children:(0,b.jsx)("em",{children:"-- Select a Friend --"})}),S.map((e=>(0,b.jsx)(p.A,{value:e.friendId,children:e.friendUsername},e.friendId)))]}),0===S.length&&!D&&(0,b.jsx)(a.A,{variant:"caption",color:"text.secondary",children:"You have no friends to challenge. Add friends from the 'Manage Friends' page."})]}),T&&(0,b.jsx)(m.A,{severity:"error",sx:{mt:1},children:T}),Q&&(0,b.jsx)(m.A,{severity:"success",sx:{mt:1},children:Q})]}),(0,b.jsxs)(g.A,{sx:{p:"16px 24px"},children:[(0,b.jsx)(A.A,{onClick:C,sx:{color:W},children:"Cancel"}),(0,b.jsx)(A.A,{onClick:async()=>{if(F)if(w&&w.questionIds&&0!==w.questionIds.length&&w.subject){P(!0),L(""),N("");try{const e={challenged_friend_id:F,topic_id:w.topicId,topic_name:w.topicName,difficulty:w.difficulty,num_questions:w.questionIds.length,quiz_class:w.quizClass||null,question_ids_json:JSON.stringify(w.questionIds),subject:w.subject},t=await j.A.post("/api/challenges",e,{headers:{Authorization:"Bearer ".concat(y.token)}});N(t.data.message||"Challenge sent successfully!"),setTimeout((()=>{C()}),2e3)}catch(n){var e,t;L((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to send challenge. They might already be in a challenge or an error occurred."),console.error("Error sending challenge:",n.response||n)}finally{P(!1)}}else L("Quiz data for challenge is incomplete or missing subject.");else L("Please select a friend to challenge.")},variant:"contained",disabled:R||D||!F||0===S.length,sx:{backgroundColor:W,color:z.palette.getContrastText(W),"&:hover":{backgroundColor:(0,f.e$)(W,.2)}},startIcon:R?(0,b.jsx)(d.A,{size:20,color:"inherit"}):(0,b.jsx)(v.A,{}),children:R?"Sending...":"Send Challenge"})]})]})}},7872:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(9379),r=n(267),i=n(4799),s=n(9826),l=n(3969),a=n(298),c=n(5895),d=n(3759),u=n(8065),h=n(2579),x=n(5362),p=n(5452),m=n(9002),g=n(3777),A=n(9468),f=n(579);const v=function(e){var t;let{result:n,onDeleteClick:v,showDeleteButton:j,isChallengeResult:b}=e;const C=(0,r.A)(),y=(0,m.Zp)();if(!n)return null;const w=(0,A.u0)(n.topicId,n.topicName,b,n),k=g.J[null===(t=n.subject)||void 0===t?void 0:t.toLowerCase()]||C.palette.grey[700];return(0,f.jsxs)(i.A,{onClick:()=>{n&&n.id&&y("/results/".concat(n.id))},sx:{p:1.5,height:"100%",display:"flex",flexDirection:"column",borderRadius:2,borderLeft:"4px solid ".concat(k),cursor:"pointer",transition:"transform 0.2s, box-shadow 0.2s","&:hover":{transform:"translateY(-3px)",boxShadow:C.shadows[5],backgroundColor:(0,s.X4)(C.palette.action.hover,.06)}},elevation:2,children:[(0,f.jsxs)(l.A,{sx:{flexGrow:1},children:[(0,f.jsxs)(a.A,{direction:"row",spacing:1,alignItems:"center",sx:{mb:1},children:[b&&(0,f.jsx)(p.A,{sx:{color:k,fontSize:"1rem"}}),(0,f.jsx)(c.A,{variant:"subtitle1",sx:{textTransform:"capitalize",fontWeight:500,color:k,lineHeight:1.2,flexGrow:1},children:w})]}),(0,f.jsxs)(l.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5,mt:.5,alignItems:"center"},children:[n.class&&(0,f.jsx)(d.A,{label:"Class ".concat(n.class),size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:"18px"}}),n.difficulty&&(0,f.jsx)(d.A,{label:n.difficulty,size:"small",variant:"outlined",sx:{textTransform:"capitalize",fontSize:"0.7rem",height:"18px"}}),(0,f.jsx)(d.A,{label:new Date(n.timestamp).toLocaleDateString(),size:"small",variant:"outlined",sx:{fontSize:"0.7rem",height:"18px"}})]})]}),(0,f.jsxs)(a.A,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mt:1.5,pt:1,borderTop:"1px solid ".concat(C.palette.divider)},children:[(0,f.jsx)(l.A,{sx:{display:"flex",alignItems:"center",gap:.5},children:(0,f.jsxs)(c.A,{variant:"body2",sx:{fontWeight:"bold"},children:[n.score,"/",n.totalQuestions]})}),(0,f.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,f.jsx)(d.A,{label:"".concat(n.percentage,"%"),sx:(0,o.A)({fontWeight:"bold",fontSize:"0.9rem",height:"26px"},(z=n.percentage,z>=70?{backgroundColor:C.palette.success.main,color:C.palette.getContrastText(C.palette.success.main)}:z>=50?{backgroundColor:C.palette.warning.main,color:C.palette.getContrastText(C.palette.warning.main)}:{backgroundColor:C.palette.error.main,color:C.palette.getContrastText(C.palette.error.main)}))}),j&&v&&(0,f.jsx)(u.A,{title:"Delete Result",children:(0,f.jsx)(h.A,{size:"small",onClick:e=>{e.stopPropagation(),v(n.id)},sx:{color:C.palette.error.light,"&:hover":{backgroundColor:(0,s.X4)(C.palette.error.main,.2)}},children:(0,f.jsx)(x.A,{fontSize:"small"})})})]})]})]});var z}},9205:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var o=n(267),r=n(3969),i=n(172),s=n(6803),l=n(2097),a=n(5895),c=n(4799),d=n(9826),u=n(9002),h=n(9161),x=n(2632),p=n(5016),m=n(9379),g=n(5043),A=n(411),f=n(9468);var v=n(3089),j=n(2306),b=n(7872),C=n(579);const y=function(e){let{results:t,isLoading:n,error:o,deleteError:r,onDeleteClick:i,currentUser:d,accentColor:h}=e;const x=(0,u.Zp)();return n?null:o?(0,C.jsx)(s.A,{severity:"error",sx:{mt:2},children:o}):r?(0,C.jsx)(s.A,{severity:"error",sx:{mt:2},children:r}):t&&0!==t.length?(0,C.jsx)(v.A,{container:!0,width:"100%",spacing:{xs:"0%",sm:"2%",md:"1%",lg:"1%",xl:"2%"},children:t.map((e=>(0,C.jsx)(v.A,{item:!0,width:{xs:"100%",sm:"49%",md:"24.25%",lg:"15.75%",xl:"15%"},sx:{mt:2},children:(0,C.jsx)(b.A,{result:e,onDeleteClick:i,showDeleteButton:d&&d.id===e.userId,isChallengeResult:!!e.challenge_id})},e.id)))}):(0,C.jsxs)(c.A,{elevation:2,sx:{p:3,textAlign:"center",mt:4,borderTop:"5px solid ".concat(h)},children:[(0,C.jsx)(a.A,{variant:"h6",gutterBottom:!0,children:"No Saved Results Found"}),(0,C.jsx)(a.A,{sx:{mb:2},children:"You haven't completed any quizzes yet under this account."}),(0,C.jsx)(l.A,{variant:"contained",startIcon:(0,C.jsx)(j.A,{}),onClick:()=>x("/subjects"),sx:{backgroundColor:h,"&:hover":{backgroundColor:e=>e.palette.augmentColor({color:{main:h}}).dark}},children:"Explore Quizzes"})]})};var w=n(3759),k=n(4527),z=n(6020),S=n(9628),I=n(1386),D=n(9130);const q=function(e){let{quizResult:t,quizTitle:n,accentColor:i}=e;const s=(0,o.A)(),l=i||s.palette.primary.main,{topicName:u,score:h,totalQuestions:x,percentage:p,difficulty:m,class:A,timeTaken:f,challenge_id:j}=t||{},[b,y]=(0,g.useState)(0),[q,F]=(0,g.useState)(0),B=(0,g.useRef)(),T=(0,g.useRef)();return(0,g.useEffect)((()=>{if(void 0===h||void 0===p||null===h||null===p)return y(0),void F(0);const e=Math.max(0,h),t=Math.max(0,Math.min(100,p)),n=(e,t,n,o,r)=>{let i=null;const s=l=>{i||(i=l);const a=Math.min((l-i)/n,1),c=1-Math.pow(1-a,3);o(Math.floor(c*(t-e)+e)),a<1?r.current=requestAnimationFrame(s):o(t)};r.current=requestAnimationFrame(s)};return y(0),F(0),B.current&&cancelAnimationFrame(B.current),T.current&&cancelAnimationFrame(T.current),n(0,e,1200,y,B),n(0,t,1200,F,T),()=>{B.current&&cancelAnimationFrame(B.current),T.current&&cancelAnimationFrame(T.current)}}),[h,p]),t?(0,C.jsxs)(c.A,{elevation:4,sx:{p:{xs:2,sm:3},mb:3,textAlign:"center",borderTop:"5px solid ".concat(l),borderRadius:1.5*s.shape.borderRadius},children:[(0,C.jsx)(a.A,{variant:"h4",component:"h1",gutterBottom:!0,sx:{color:l,fontWeight:"bold",mb:1,fontSize:{xs:"1.8rem",sm:"2.125rem"}},children:n||(j?"Challenge Results":"Quiz Results")}),(0,C.jsx)(a.A,{variant:"h6",component:"h2",gutterBottom:!0,sx:{textTransform:"capitalize",color:s.palette.text.secondary,mb:2,fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:u||"N/A"}),(0,C.jsxs)(v.A,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",sx:{mb:2},children:[A&&(0,C.jsx)(v.A,{item:!0,children:(0,C.jsx)(w.A,{label:"Class ".concat(A),size:"small",variant:"outlined",sx:{borderColor:l,color:l}})}),m&&(0,C.jsx)(v.A,{item:!0,children:(0,C.jsx)(w.A,{label:m,size:"small",variant:"outlined",sx:{textTransform:"capitalize",borderColor:l,color:l}})}),null!=x&&x>0&&(0,C.jsx)(v.A,{item:!0,children:(0,C.jsx)(w.A,{label:"".concat(x," Qs"),size:"small",variant:"outlined",sx:{borderColor:l,color:l}})}),null!=f&&(0,C.jsx)(v.A,{item:!0,children:(0,C.jsx)(w.A,{icon:(0,C.jsx)(S.A,{fontSize:"small"}),label:(0,I.f)(f),size:"small",variant:"outlined",sx:{borderColor:l,color:l}})})]}),(0,C.jsx)(k.A,{sx:{my:2,borderColor:s.palette.divider}}),(0,C.jsxs)(r.A,{sx:{my:2.5},children:[(0,C.jsxs)(a.A,{variant:"h5",component:"div",sx:{fontWeight:500,mb:.5,fontSize:{xs:"1.2rem",sm:"1.5rem"}},children:["Your Score:",(0,C.jsxs)(a.A,{component:"span",variant:"h3",sx:{color:l,fontWeight:"bold",ml:1,fontSize:{xs:"2rem",sm:"2.5rem",md:"3rem"}},children:[b," / ",x||0," "]})]}),(0,C.jsxs)(r.A,{sx:{width:"100%",maxWidth:"400px",margin:"auto",mt:1,mb:1.5},children:[(0,C.jsx)(z.A,{variant:"determinate",value:q,sx:{height:10,borderRadius:5,backgroundColor:(0,d.X4)(l,.2),"& .MuiLinearProgress-bar":{backgroundColor:l}}}),(0,C.jsxs)(a.A,{variant:"h4",component:"div",sx:{color:l,fontWeight:"bold",mt:.5,fontSize:{xs:"1.8rem",sm:"2.125rem",md:"2.5rem"}},children:[q,"%",(p>=90||100===p)&&(0,C.jsx)(D.A,{sx:{color:s.palette.warning.main,verticalAlign:"middle",fontSize:{xs:"2rem",sm:"2.5rem"},ml:.5}})]})]})]})]}):(0,C.jsx)(a.A,{sx:{p:2,textAlign:"center"},children:"Loading summary..."})};var F=n(5315),B=n(2394),T=n(9801),L=n(6185),Q=n(687),N=n(9508),R=n(4100),P=n(149),W=n(441);const H=function(e){let{detailedQuestionsToDisplay:t}=e;const n=(0,o.A)(),i=n.palette.success.main,s=n.palette.error.main,l=n.palette.grey[700];return t&&0!==t.length?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(a.A,{variant:"h5",gutterBottom:!0,sx:{mt:3,mb:2,display:"flex",alignItems:"center",color:n.palette.text.primary},children:"Detailed Breakdown"}),t.map(((e,o)=>(0,C.jsxs)(c.A,{elevation:2,sx:{mb:3,p:{xs:2,sm:2.5},borderLeft:"4px solid ".concat(e.isCorrect?i:e.isAnswered?s:l)},children:[(0,C.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[(0,C.jsxs)(a.A,{variant:"h6",component:"div",sx:{fontWeight:500,color:n.palette.text.primary},children:[" Question ",o+1," "]}),e.isAnswered?e.isCorrect?(0,C.jsx)(w.A,{icon:(0,C.jsx)(Q.A,{}),label:"Correct",color:"success",size:"small",variant:"outlined"}):(0,C.jsx)(w.A,{icon:(0,C.jsx)(N.A,{}),label:"Incorrect",color:"error",size:"small",variant:"outlined"}):(0,C.jsx)(w.A,{label:"Not Answered",size:"small",variant:"outlined"})]}),(0,C.jsx)(r.A,{sx:{mb:2,color:n.palette.text.primary,whiteSpace:"pre-wrap"},children:(0,C.jsx)(W.A,{text:e.text})}),Array.isArray(e.options)&&e.options.length>0?(0,C.jsx)(F.A,{dense:!0,sx:{py:0,mb:e.explanation?1.5:0},children:e.options.map((t=>{const o=t.id===e.userAnswerId,r=t.id===e.correctOptionId;let l={},a=(0,C.jsx)(R.A,{fontSize:"small",sx:{color:n.palette.action.disabled}});return r&&(l={backgroundColor:(0,d.X4)(i,.2),border:"1px solid ".concat((0,d.X4)(i,.4)),color:n.palette.success.light},a=(0,C.jsx)(Q.A,{fontSize:"small",sx:{color:i}})),o&&(a=(0,C.jsx)(P.A,{fontSize:"small",sx:{color:r?i:s}}),r?l.fontWeight="bold":l=(0,m.A)((0,m.A)({},l),{},{backgroundColor:(0,d.X4)(s,.2),border:"1px solid ".concat((0,d.X4)(s,.4)),color:n.palette.error.light})),(0,C.jsxs)(B.Ay,{sx:(0,m.A)({my:.5,borderRadius:n.shape.borderRadius,py:1,px:1.5,border:"1px solid ".concat(n.palette.divider),transition:"background-color 0.2s, border-color 0.2s"},l),children:[(0,C.jsx)(T.A,{sx:{minWidth:"auto",mr:1.5,alignItems:"center"},children:a}),(0,C.jsx)(L.A,{primary:(0,C.jsx)(W.A,{text:t.text}),primaryTypographyProps:{variant:"body1",fontWeight:o?"bold":"normal",color:l.color||n.palette.text.primary,whiteSpace:"pre-wrap"}})]},t.id)}))}):(0,C.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{fontStyle:"italic"},children:"Options not available for this question."}),e.explanation&&(0,C.jsxs)(c.A,{elevation:0,sx:{mt:1.5,p:1.5,backgroundColor:(0,d.X4)(n.palette.info.dark,.2),borderRadius:1},children:[(0,C.jsx)(a.A,{variant:"subtitle2",sx:{color:n.palette.info.light,fontWeight:"bold",mb:.5},children:"Explanation:"}),(0,C.jsx)(W.A,{text:e.explanation})]}),(0,C.jsx)(k.A,{sx:{mt:2,display:o===t.length-1?"none":"block"}})]},e.id||"q-".concat(o,"-").concat(Math.random()))))]}):(0,C.jsx)(a.A,{sx:{textAlign:"center",my:2},children:"No question breakdown available for this result."})};var M=n(8315),U=n(5362);const E=function(e){let{onBackToList:t,onNavigateHome:n,onViewHistory:i,showBackToListButton:s,showViewHistoryButton:a,accentColor:c,showDeleteButton:u,onDeleteClick:x,deleteDisabled:p}=e;const m=(0,o.A)(),g=c||m.palette.primary.main;return(0,C.jsxs)(r.A,{sx:{mt:4,py:2,display:"flex",justifyContent:"space-around",alignItems:"center",gap:2,flexWrap:"wrap"},children:[s&&t&&(0,C.jsx)(l.A,{variant:"outlined",startIcon:(0,C.jsx)(M.A,{}),onClick:t,sx:{borderColor:g,color:g,"&:hover":{borderColor:(0,d.e$)(g,.15),backgroundColor:(0,d.X4)(g,.08)},minWidth:{xs:"100%",sm:"180px"}},children:" Back to List "}),a&&i&&(0,C.jsx)(l.A,{variant:"outlined",startIcon:(0,C.jsx)(h.A,{}),onClick:i,sx:{borderColor:m.palette.info.main,color:m.palette.info.main,"&:hover":{borderColor:(0,d.e$)(m.palette.info.main,.15),backgroundColor:(0,d.X4)(m.palette.info.main,.08)},minWidth:{xs:"100%",sm:"180px"}},children:" View Full History "}),(0,C.jsx)(l.A,{variant:"outlined",startIcon:(0,C.jsx)(j.A,{}),onClick:n,sx:{borderColor:s||a?g:m.palette.primary.main,color:s||a?g:m.palette.primary.main,"&:hover":{borderColor:(0,d.e$)(s||a?g:m.palette.primary.main,.15),backgroundColor:(0,d.X4)(s||a?g:m.palette.primary.main,.08)},minWidth:{xs:"100%",sm:"180px"}},children:s||a?"Home":"Back to Home"}),u&&x&&(0,C.jsx)(l.A,{variant:"outlined",color:"error",startIcon:(0,C.jsx)(U.A,{}),onClick:x,disabled:p,sx:{minWidth:{xs:"100%",sm:"180px"}},children:"Delete This Result"})]})};var O=n(3777);const _=function(e){var t;let{selectedResult:n,detailedQuestions:o,isLoadingDetails:l,detailsError:c,onBackToList:d,onNavigateHome:u,onOpenDeleteDialog:h,onOpenChallengeSetup:x,currentUser:p,accentColor:m}=e;if(!n)return null;const g=O.J[null===(t=n.subject)||void 0===t?void 0:t.toLowerCase()]||m;return(0,C.jsxs)(r.A,{sx:{p:{xs:1,sm:2,md:3},maxWidth:"900px",margin:"auto",mt:2},children:[(0,C.jsx)(q,{quizResult:n,quizTitle:n.challenge_id?"Past Challenge Details":"Past Quiz Details",accentColor:g}),l?(0,C.jsxs)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"20vh",sx:{my:2},children:[(0,C.jsx)(i.A,{sx:{color:g}}),(0,C.jsx)(a.A,{sx:{ml:2},children:"Loading question details..."})]}):c?(0,C.jsx)(s.A,{severity:"error",sx:{mt:2},children:c}):o&&o.length>0?(0,C.jsx)(H,{detailedQuestionsToDisplay:o}):(0,C.jsx)(s.A,{severity:"info",sx:{mt:2},children:"No detailed question breakdown available or no questions were attempted for this result."}),(0,C.jsx)(E,{onBackToList:d,onNavigateHome:u,showBackToListButton:!0,accentColor:g,showDeleteButton:p&&p.id===n.userId,onDeleteClick:()=>h(n.id),deleteDisabled:!n.id||!(p&&p.id===n.userId),onChallengeFriend:()=>x(n),showChallengeButton:p&&!!n.questionsActuallyAttemptedIds&&n.questionsActuallyAttemptedIds.length>0&&!n.challenge_id})]})};var X=n(5979);const Y=function(e){let{onAnimationComplete:t}=e;const n=(0,o.A)(),[i,s]=(0,g.useState)(!1),l=(0,g.useRef)(null);(0,g.useEffect)((()=>(s(!0),l.current=setTimeout((()=>{t()}),2e3),()=>{l.current&&clearTimeout(l.current)})),[t]);const a={xs:"150px",sm:"200px",md:"250px",lg:"300px"};return(0,C.jsx)(r.A,{sx:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.98)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:n.zIndex.modal+10,cursor:"default"},children:(0,C.jsx)(r.A,{sx:{width:{xs:"90vw",sm:"80vw",md:"70vw",lg:"60vw"},height:{xs:"70vh",sm:"80vh",md:"65vh",lg:"60vh"},minHeight:"500px",backgroundColor:"black",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",borderRadius:2*n.shape.borderRadius,boxShadow:n.shadows[15],padding:n.spacing(3),textAlign:"center",position:"relative",overflow:"hidden"},children:(0,C.jsxs)(r.A,{sx:{position:"relative",width:a,height:a,zIndex:2},children:[(0,C.jsx)(X.A,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",fontSize:"inherit",color:n.palette.grey[800]}}),(0,C.jsx)(X.A,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",fontSize:"inherit",color:n.palette.common.white,clipPath:i?"inset(0% 0 0 0)":"inset(100% 0 0 0)",transition:"clip-path 1.8s cubic-bezier(0.4, 0, 0.2, 1)"}})]})})})};var V=n(9733),$=n(2199);const J=function(){var e,t;const n=(0,o.A)(),v=(0,u.Zp)(),{isLoadingAuth:j}=(0,p.A)(),{currentUser:b,view:w,isLoading:k,error:z,detailData:S,historicalList:I,showAnimation:D,handleAnimationComplete:q,deleteConfirmationOpen:F,deleteError:B,challengeSetupModalOpen:T,quizDataForChallenge:L,handleBackToList:Q,handleNavigateHome:N,openDeleteConfirmation:R,closeDeleteConfirmation:P,handleConfirmDelete:W,handleOpenChallengeSetup:H,handleCloseChallengeSetupModal:M}=(()=>{var e;const t=(0,u.zy)(),n=(0,u.Zp)(),{resultId:o}=(0,u.g)(),{currentUser:r}=(0,p.A)(),[i,s]=(0,g.useState)("loading"),[l,a]=(0,g.useState)(null),[c,d]=(0,g.useState)([]),[h,x]=(0,g.useState)(""),[v,j]=(0,g.useState)(!0),[b,C]=(0,g.useState)(!0===(null===(e=t.state)||void 0===e?void 0:e.isFirstResultView)),[y,w]=(0,g.useState)(!1),[k,z]=(0,g.useState)(null),[S,I]=(0,g.useState)(""),[D,q]=(0,g.useState)(!1),[F,B]=(0,g.useState)(null),T=(0,g.useCallback)((async e=>{j(!0),x("");try{if(null===r||void 0===r||!r.token)throw new Error("Authentication required to view saved results.");const t=((await A.A.get("/api/results",{headers:{Authorization:"Bearer ".concat(r.token)}})).data||[]).find((t=>String(t.id)===String(e)));if(!t)throw new Error("Result with ID ".concat(e," not found or you do not have permission to view it."));const n=await A.A.get("/api/questions?topicId=".concat(t.topicId)),o=(0,f.a3)(n.data||[]),i=(t.questionsActuallyAttemptedIds||[]).map((e=>{const n=o.find((t=>t.id===e))||{id:e,text:"Question data (ID: ".concat(e,") not found."),options:[]},r=t.userAnswersSnapshot?t.userAnswersSnapshot[e]:null;return(0,m.A)((0,m.A)({},n),{},{userAnswerId:r,isCorrect:r===n.correctOptionId,isAnswered:!!r})}));a({result:(0,m.A)((0,m.A)({},t),{},{topicName:(0,f.u0)(t.topicId,t.topicName,!!t.challenge_id,t)}),detailedQuestions:i}),s("detail")}catch(t){x(t.message),s("error")}finally{j(!1)}}),[null===r||void 0===r?void 0:r.token]),L=(0,g.useCallback)((async()=>{if(null===r||void 0===r||!r.token)return j(!1),s("list"),void d([]);j(!0),x("");try{const e=await A.A.get("/api/results?userId=".concat(r.id),{headers:{Authorization:"Bearer ".concat(r.token)}});d((e.data||[]).map((e=>(0,m.A)((0,m.A)({},e),{},{topicName:(0,f.u0)(e.topicId,e.topicName,!!e.challenge_id,e)})))),s("list")}catch(e){x(e.message),d([]),s("error")}finally{j(!1)}}),[r]);(0,g.useEffect)((()=>{const e=t.state;e&&e.originalQuestionsForDisplay?(C(!0===e.isFirstResultView),a({result:(0,m.A)((0,m.A)({},e),{},{topicName:(0,f.u0)(e.topicId,e.topicName,e.isChallenge,e.challengeDetails)}),detailedQuestions:(e.originalQuestionsForDisplay||[]).map((t=>(0,m.A)((0,m.A)({},t),{},{userAnswerId:e.originalAnswersForDisplay[t.id],isCorrect:e.originalAnswersForDisplay[t.id]===t.correctOptionId,isAnswered:!!e.originalAnswersForDisplay[t.id]})))}),s("detail"),j(!1)):o?T(o):L()}),[o,t.state,T,L]);const Q=()=>n("/results",{replace:!0}),N=()=>{w(!1),I("")};return{currentUser:r,view:i,isLoading:v,error:h,detailData:l,historicalList:c,showAnimation:b,handleAnimationComplete:()=>{C(!1),t.state&&n(t.pathname,{state:(0,m.A)((0,m.A)({},t.state),{},{isFirstResultView:!1}),replace:!0})},deleteConfirmationOpen:y,deleteError:S,challengeSetupModalOpen:D,quizDataForChallenge:F,handleBackToList:Q,handleNavigateHome:()=>n("/"),openDeleteConfirmation:e=>{z(e),w(!0)},closeDeleteConfirmation:N,handleConfirmDelete:async()=>{if(k&&null!==r&&void 0!==r&&r.token)try{await A.A.delete("/api/results/".concat(k),{headers:{Authorization:"Bearer ".concat(r.token)}}),N(),Q()}catch(n){var e,t;I((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to delete result.")}},handleOpenChallengeSetup:e=>{const t=Array.isArray(e.originalQuestionsForDisplay)?e.originalQuestionsForDisplay.map((e=>e.id)):e.questionsActuallyAttemptedIds;null!==t&&void 0!==t&&t.length?(B({topicId:e.topicId,topicName:(0,f.u0)(e.topicId,e.topicName,!!e.challenge_id,e),difficulty:e.difficulty,numQuestions:t.length,quizClass:e.class||e.quizClass,questionIds:t,subject:e.subject}),q(!0)):alert("No questions found to base a challenge on.")},handleCloseChallengeSetupModal:()=>q(!1)}})(),U=(null===(e=n.palette.resultsAccent)||void 0===e?void 0:e.main)||n.palette.info.main;return(0,C.jsxs)(C.Fragment,{children:[D&&(0,C.jsx)(Y,{onAnimationComplete:q}),(0,C.jsx)(r.A,{sx:{p:{xs:1,sm:2,md:3},margin:"auto",mt:2,visibility:D?"hidden":"visible"},children:j||"loading"===w?(0,C.jsx)(r.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"calc(100vh - 200px)",children:(0,C.jsx)(i.A,{sx:{color:U}})}):"error"===w?(0,C.jsxs)(r.A,{textAlign:"center",mt:4,children:[(0,C.jsx)(s.A,{severity:"error",children:z||"An unknown error occurred."}),(0,C.jsx)(l.A,{variant:"outlined",onClick:Q,sx:{mt:2},children:"Go Back to Results List"})]}):"detail"===w&&S?(0,C.jsx)(_,{selectedResult:S.result,detailedQuestions:S.detailedQuestions,isLoadingDetails:k,detailsError:z,onBackToList:Q,onNavigateHome:N,onOpenDeleteDialog:R,onOpenChallengeSetup:()=>H(S.result),currentUser:b,accentColor:U}):"list"===w?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(a.A,{variant:"h4",gutterBottom:!0,sx:{mb:2,textAlign:"center",color:U,fontWeight:"bold"},children:[(0,C.jsx)(h.A,{sx:{verticalAlign:"middle",mr:1,fontSize:"1.3em"}}),b?"".concat(b.name,"'s Quiz History"):"Quiz History"]}),b?(0,C.jsx)(y,{results:I,isLoading:k,error:z,deleteError:B,onDeleteClick:R,currentUser:b,accentColor:U}):(0,C.jsxs)(c.A,{elevation:2,sx:{p:3,textAlign:"center",mt:3,borderTop:"5px solid ".concat(U)},children:[(0,C.jsx)(a.A,{variant:"h6",gutterBottom:!0,children:"Access Your Quiz History"}),(0,C.jsx)(a.A,{sx:{mb:2},children:"Please log in to view your saved results."}),(0,C.jsx)(l.A,{variant:"contained",startIcon:(0,C.jsx)(x.A,{}),onClick:()=>v("/login"),sx:{backgroundColor:U,"&:hover":{backgroundColor:(0,d.e$)(U,.2)}},children:"Login / Register"})]})]}):null}),(0,C.jsx)(V.A,{open:F,onClose:P,onConfirm:W,title:"Confirm Deletion",message:"Are you sure you want to permanently delete this quiz result? This action cannot be undone.",error:B}),L&&(0,C.jsx)($.A,{open:T,onClose:M,currentUser:b,quizDataForChallenge:L,accentColor:O.J[null===(t=L.subject)||void 0===t?void 0:t.toLowerCase()]||n.palette.secondary.main})]})}},9468:(e,t,n)=>{n.d(t,{R3:()=>s,a3:()=>r,u0:()=>i});var o=n(9379);const r=e=>Array.isArray(e)?e.map((e=>{if(!e||"object"!==typeof e)return console.warn("[quizUtils] Encountered invalid item in questionsArray:",e),e;let t=[];if("string"===typeof e.options)try{t=JSON.parse(e.options),Array.isArray(t)||(console.warn("[quizUtils] Parsed options for Q ID ".concat(e.id," is not an array:"),t),t=[])}catch(n){console.error("[quizUtils] Failed to parse options for question ID ".concat(e.id,":"),e.options,n)}else Array.isArray(e.options)?t=e.options:void 0!==e.options&&null!==e.options&&console.warn("[quizUtils] Question ID ".concat(e.id," has unexpected options format (not string or array):"),e.options);return(0,o.A)((0,o.A)({},e),{},{options:t})})):(console.warn("[quizUtils] parseQuestionOptions received non-array input:",e),[]),i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(n&&null!==o&&void 0!==o&&o.topic_name)return"Challenge: ".concat(o.topic_name);if(n&&t)return"Challenge: ".concat(t);if(n)return"Challenge: ".concat(e?String(e).replace(/-/g," "):"Quiz");if(t&&e&&t!==String(e).replace(/-/g," "))return t;if(!e)return"N/A";let r=String(e).replace(/-/g," ");r=r.replace(/^homibhabha practice /i,"Homi Bhabha Practice - "),r=r.replace(/^pyq /i,"PYQ ");return r=r.replace(/\s(\d+(?:st|nd|rd|th))$/i,((e,t)=>" - Class ".concat(t.toUpperCase()))).trim(),r=r.split(" ").map((e=>"class"===e.toLowerCase()||"std"===e.toLowerCase()?e:e.includes("-")?e.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join("-"):e.charAt(0).toUpperCase()+e.slice(1).toLowerCase())).join(" "),r=r.replace(/Homi Bhabha Practice - (\w+) (\w+)/i,((e,t,n)=>"Homi Bhabha Practice - Std ".concat(t," (").concat(n.charAt(0).toUpperCase()+n.slice(1),")"))),r=r.replace(/Pyq (\w+) (\d+)/i,((e,t,n)=>"PYQ - Std ".concat(t," (").concat(n,")"))),r=r.replace(/Pyq - Class (\w+) \((\d+)\)/i,((e,t,n)=>"PYQ - Std ".concat(t," (").concat(n,")"))),r},s=e=>{if(!e||!Array.isArray(e))return[];let t,n=e.length;for(;0!==n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e}},9733:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(267),r=n(3023),i=n(1911),s=n(8776),l=n(9200),a=n(6803),c=n(5877),d=n(2097),u=n(579);const h=function(e){let{open:t,onClose:n,onConfirm:h,error:x}=e;const p=(0,o.A)();return(0,u.jsxs)(r.A,{open:t,onClose:n,"aria-labelledby":"delete-confirmation-title",children:[(0,u.jsx)(i.A,{id:"delete-confirmation-title",children:"Confirm Deletion"}),(0,u.jsxs)(s.A,{children:[(0,u.jsx)(l.A,{children:"Are you sure you want to delete this quiz result? This action cannot be undone."}),x&&(0,u.jsx)(a.A,{severity:"error",sx:{mt:2},variant:"filled",children:x})]}),(0,u.jsxs)(c.A,{children:[(0,u.jsx)(d.A,{onClick:n,sx:{color:p.palette.text.secondary},children:"Cancel"}),(0,u.jsx)(d.A,{onClick:h,color:"error",autoFocus:!0,children:"Delete"})]})]})}}}]);
//# sourceMappingURL=205.41f39dd0.chunk.js.map